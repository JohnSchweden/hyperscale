---
phase: 01-layout-foundation
plan: 08
type: execute
wave: 1
depends_on: []
files_modified: [App.tsx, index.html]
autonomous: true
gap_closure: true

must_haves:
  truths:
    - "No scrollbar on first render; content fits viewport without scroll"
    - "Stage transitions don't cause temporary overflow"
  artifacts:
    - path: "App.tsx"
      provides: "Root div without overflow-y-auto"
      changes: "Remove overflow-y-auto class from root div (line 963)"
    - path: "index.html"
      provides: "Body without conflicting overflow"
      changes: "Change body overflow-y-auto to overflow-y-hidden (line 24)"
  key_links:
    - from: "App.tsx stage-transition"
      to: "index.html body overflow"
      pattern: "No transform animation causing scrollbar"
---

<objective>
Fix scrollbar visibility on first render by removing conflicting overflow declarations and adjusting stage transition animation.

Purpose: On desktop, users see a scrollbar briefly when switching stages due to temporary overflow during the stage-transition animation's translateY(20px) transform.

Output: Clean first render with no scrollbar flicker.
</objective>

<execution_context>
@/Users/yevgenschweden/.config/opencode/get-shit-done/workflows/execute-plan.md
@/Users/yevgenschweden/.config/opencode/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/ROADMAP.md
@.planning/STATE.md
@.planning/phases/01-layout-foundation/01-UAT.md
@/Users/yevgenschweden/hyperscale/App.tsx
@/Users/yevgenschweden/hyperscale/index.html

## Gap Details (from UAT)

**Gap 1: Scrollbar First Render (Minor)**
- Truth: "No scrollbar on first render; content fits viewport without scroll"
- Status: Failed
- Root cause: `overflow-y-auto` on App root div + stage-transition animation's `translateY(20px)` causes temporary overflow during animation initial frame
- Artifacts:
  - `App.tsx` line 963: Root div has `overflow-y-auto` which shouldn't be needed
  - `index.html` line 24: Body has `overflow-y-auto` creating duplicate scroll context
  - `index.html` line 122-127: stage-transition animation starts at `translateY(20px)`, pushing content down temporarily
</context>

<tasks>

<task type="auto">
  <name>Fix App.tsx root overflow</name>
  <files>App.tsx (line 963)</files>
  <action>
    Remove `overflow-y-auto` from the root div's className on line 963.
    
    Current code (line 963):
    ```tsx
    return (
      <div className="min-h-[100dvh] overflow-y-auto stage-transition" key={state.stage}>
        {renderStage()}
      </div>
    );
    ```
    
    Change to:
    ```tsx
    return (
      <div className="min-h-[100dvh] stage-transition" key={state.stage}>
        {renderStage()}
      </div>
    );
    ```
    
    Rationale: The `overflow-y-auto` was causing scrollbar to appear temporarily during the translateY(20px) animation. The stage transition animation creates content that briefly exceeds viewport height.
  </action>
  <verify>Search App.tsx for `overflow-y-auto` on root div - should return no results or show only the class removed</verify>
  <done>Root div no longer has overflow-y-auto class; className is now "min-h-[100dvh] stage-transition"</done>
</task>

<task type="auto">
  <name>Fix index.html body overflow</name>
  <files>index.html (line 24)</files>
  <action>
    Change body overflow from `overflow-y: auto` to `overflow-y: hidden` on line 24.
    
    Current code (line 20-26):
    ```css
    body {
        font-family: 'Space Grotesk', sans-serif;
        background-color: #0a0a0c;
        color: #e2e8f0;
        overflow-y: auto;
        overflow-x: hidden;
    }
    ```
    
    Change to:
    ```css
    body {
        font-family: 'Space Grotesk', sans-serif;
        background-color: #0a0a0c;
        color: #e2e8f0;
        overflow-y: hidden;
        overflow-x: hidden;
    }
    ```
    
    Rationale: `overflow-y: auto` on body creates a redundant scroll context that conflicts with the LayoutShell's min-h-[100dvh] and can cause scrollbar appearance during animations. Using `hidden` prevents body-level scrolling - all scrolling should happen within LayoutShell content if needed.
  </action>
  <verify>Check index.html line 24 - should show `overflow-y: hidden;`</verify>
  <done>Body overflow-y is now hidden, preventing duplicate scroll context</done>
</task>

<task type="auto">
  <name>Adjust stage transition animation</name>
  <files>index.html (lines 115-128)</files>
  <action>
    Modify the stage-transition animation to use a more subtle entrance that doesn't cause overflow.
    
    Current animation (lines 119-128):
    ```css
    @keyframes fadeSlideIn {
        from {
            opacity: 0;
            transform: translateY(20px) scale(0.98);
        }
        to {
            opacity: 1;
            transform: translateY(0) scale(1);
        }
    }
    ```
    
    Change to (reduce translateY to 10px to minimize overflow risk):
    ```css
    @keyframes fadeSlideIn {
        from {
            opacity: 0;
            transform: translateY(10px) scale(0.98);
        }
        to {
            opacity: 1;
            transform: translateY(0) scale(1);
        }
    }
    ```
    
    Rationale: Reducing translateY from 20px to 10px minimizes the chance of content briefly exceeding viewport height. Combined with overflow removal, this ensures no scrollbar appears during stage transitions.
  </action>
  <verify>Check index.html for translateY value in fadeSlideIn keyframe - should be 10px</verify>
  <done>Animation translateY reduced to 10px, eliminating overflow risk</done>
</task>

</tasks>

<verification>

### Automated Verification
1. **Code review**: Confirm both files modified correctly
2. **Build check**: `bun run build` should complete without errors

### Manual Verification Steps
1. Open the app in desktop browser
2. Navigate through all 8 stages (Intro → Personality → Role → Initializing → Game → Boss → Game Over → Summary)
3. **Watch for scrollbar on first render of each stage** - should NOT appear
4. Check that no scrollbar appears during stage transitions

### Success Criteria
- [ ] No scrollbar visible when first loading any stage
- [ ] No scrollbar flicker during stage navigation
- [ ] All 8 stages display without overflow indicators

</verification>

<success_criteria>
- **Observable truth**: "No scrollbar on first render; content fits viewport without scroll" - User can navigate all 8 stages without seeing scrollbar
- **Code changes**: App.tsx root div lacks overflow-y-auto; index.html body has overflow-y: hidden
- **Animation**: translateY reduced from 20px to 10px
- **Build**: Passes without errors
</success_criteria>

<output>
After completion, create `.planning/phases/01-layout-foundation/01-08-SUMMARY.md`

Include:
- Changes made to App.tsx and index.html
- Verification results
- Any additional notes
</output>
